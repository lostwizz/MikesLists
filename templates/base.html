<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MikesLists</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>

    <style>
        body {
            display: flex;
            min-height: 100vh;
        }
        #sidebar {
            width: 240px;
            background: var(--bs-dark);
            color: white;
        }
        #sidebar a {
            color: #ddd;
            text-decoration: none;
            padding: 12px 20px;
            display: block;
        }
        #sidebar a:hover {
            background: rgba(255,255,255,0.1);
        }
        #sidebar a.active {
            background: rgba(255,255,255,0.2);
            color: #fff;
        }
        #content {
            flex-grow: 1;
            padding: 20px;
        }
    </style>
</head>

<body class="bg-light">

<div id="sidebar">
    <h4 class="p-3">MikesLists</h4>

    <div class="px-3 py-2 text-light small">
        <div><strong>User:</strong> {{ sidebar_username }}</div>
        <div><strong>IP:</strong> {{ sidebar_ip }}</div>
    </div>

    <hr class="border-secondary">

    <a href="{% url 'accounts:dashboard' %}" class="{% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">
        Dashboard
    </a>
    <a href="{% url 'todo:list_dashboard' %}" class="{% if request.resolver_match.url_name == 'list_dashboard' %}active{% endif %}">
        Lists
    </a>
    <a href="{% url 'todo:todo_items' %}" class="{% if request.resolver_match.url_name == 'todo_items' %}active{% endif %}">
        Items
    </a>
    <a href="{% url 'accounts:profile_view' %}" class="{% if request.resolver_match.url_name == 'profile_view' %}active{% endif %}">
        Profile
    </a>

    <hr class="border-secondary">

    <a href="#" id="dark-mode-toggle">Toggle Dark Mode</a>
   <form action="{% url 'accounts:logout' %}" method="post" style="display:inline;">
  {% csrf_token %}
  <button type="submit" class="btn btn-link text-warning" style="padding:0; border:none; background:none;">
    Logout
  </button>
</form>




</div>

<div id="content">
    {% block content %}{% endblock %}
</div>

<!-- Toast container -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1100;">
    <div id="toast" class="toast text-bg-success border-0" role="alert">
        <div class="toast-body" id="toast-body"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Restore dark mode
    if (localStorage.getItem("dark-mode") === "true") {
        document.body.classList.add("bg-dark", "text-light");
        document.getElementById("sidebar").classList.add("bg-secondary");
    }

    // Toggle dark mode
    document.getElementById("dark-mode-toggle").onclick = function () {
        document.body.classList.toggle("bg-dark");
        document.body.classList.toggle("text-light");
        document.getElementById("sidebar").classList.toggle("bg-secondary");

        const isDark = document.body.classList.contains("bg-dark");
        localStorage.setItem("dark-mode", isDark);
    };

    // Toast helper
    function showToast(message) {
        document.getElementById("toast-body").innerText = message;
        const toast = new bootstrap.Toast(document.getElementById("toast"));
        toast.show();
    }

    // HTMX success notifications
    document.body.addEventListener("htmx:afterRequest", function(evt) {
        if (evt.detail.successful) {
            showToast("Action completed successfully");
        }
    });
</script>

</body>
</html>
